# [Basic Malware RE](https://tryhackme.com/room/basicmalwarere)

## This room aims towards helping everyone learn about the basics of "Malware Reverse Engineering".

# Strings :: Challenge 1

## This executable prints an MD5 Hash on the screen when executed. Can you grab the exact flag?

### What is the flag of which that MD5 gets generated?

1. Import the `strings1.exe_` file into Ghidra

2. After the initial analysis completes, navigate to the `Functions` panel in the Symbol Tree window, locate the `entry` function, and double-click to open it in the Decompiler window

3. Within the decompiled code, look for references to `md5_hash` function parameter

![SCREEN01](https://github.com/user-attachments/assets/155d7307-7edb-4733-afb8-779cc3a496b1)

4. Double-click on the entry at address `004022b4` to navigate to where the flag is being used

![SCREEN02](https://github.com/user-attachments/assets/0bea436c-8a30-4d87-88a5-f787d3720d9e)

5. In the decompiled code, you should be able to see the original flag string that's being passed to the MD5 hash function

![SCREEN03](https://github.com/user-attachments/assets/5e1359b3-3ea0-49c0-b2c9-300e696ee9a3)

---

### Strings :: Challenge 2

1. Import the `strings2.exe_` file into Ghidra and wait for the analysis to complete

2. Navigate to `Functions` -> `entry` in the Symbol Tree and examine the decompiled code. As you scroll down, you'll notice a large stack of hexadecimal values

![SCREEN04](https://github.com/user-attachments/assets/e2755e79-b811-4f45-a5d0-1b1094ece172)

3. Select and copy the entire stack of hex values. This appears to be encoded data that we need to decode

![SCREEN05](https://github.com/user-attachments/assets/864dde91-d1c6-410c-90de-2bbf28cec47c)

4. Open [CyberChef](https://gchq.github.io/CyberChef/) and use the following recipe:
   - Add the **Find / Replace** operation with Find values `^[^,]*,` and replace with empty string (This removes the memory addresses and commas, leaving only the hex values)
   - Then add the **From Hex** operation to convert the hex values to ASCII text

![SCREEN06](https://github.com/user-attachments/assets/733e73fc-a068-484c-bdd6-fccc1549c9d6)

---

### Strings :: Challenge 3

1. Import the `strings3.exe_` file into Ghidra and wait for the analysis to complete

2. Navigate to `Functions` -> `entry` in the Symbol Tree and examine the decompiled code

3. Look for calls to the `LoadStringA` function, which is used to load strings from a program's resource section. Click on the `0x110` address parameter in the `LoadStringA` function call - this is the resource ID of the string being loaded

![SCREEN07](https://github.com/user-attachments/assets/3009f710-0188-4edd-b846-bed892cbabdd)

4. Follow the execution flow by clicking on the `CALL` instruction that invokes `LoadStringA`.

![SCREEN08](https://github.com/user-attachments/assets/3af99155-c8a2-4359-bf19-cb3264916022)

5. In the resulting view, the first flag that appears is the one we're looking for

![SCREEN09](https://github.com/user-attachments/assets/f01e6d95-2369-473d-81c3-4cc6a03170f5)
